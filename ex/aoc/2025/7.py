TEXT = """......................................................................S......................................................................
.............................................................................................................................................
......................................................................^......................................................................
.............................................................................................................................................
.....................................................................^.^.....................................................................
.............................................................................................................................................
....................................................................^.^.^....................................................................
.............................................................................................................................................
...................................................................^.^.^.^...................................................................
.............................................................................................................................................
..................................................................^.^...^.^..................................................................
.............................................................................................................................................
.................................................................^.^.^.^.^.^.................................................................
.............................................................................................................................................
................................................................^.....^.....^................................................................
.............................................................................................................................................
...............................................................^.^.^.......^.^...............................................................
.............................................................................................................................................
..............................................................^...^.^.^...^.^.^..............................................................
.............................................................................................................................................
.............................................................^.^.^.....^.^...^.^.............................................................
.............................................................................................................................................
............................................................^.........^.^.^.^...^............................................................
.............................................................................................................................................
...........................................................^.^.^...^...^...^.^...^...........................................................
.............................................................................................................................................
..........................................................^.^.^.^.^.^.....^...^.^.^..........................................................
.............................................................................................................................................
.........................................................^.^.....^.^.^.....^.......^.........................................................
.............................................................................................................................................
........................................................^.........^.^.^.^.^.^...^.^.^........................................................
.............................................................................................................................................
.......................................................^.....^.^.^...^.^.......^.....^.......................................................
.............................................................................................................................................
......................................................^...^.^.^.^.^.^.^.^.^.....^...^.^......................................................
.............................................................................................................................................
.....................................................^.^.^.^.^.^.^.^.^...............^.^.....................................................
.............................................................................................................................................
....................................................^.^.^.^.......^...^.^.^.^.^.^.....^.^....................................................
.............................................................................................................................................
...................................................^.^.....^.^.^.^.....^.^.^.^.^.^.^.^...^...................................................
.............................................................................................................................................
..................................................^.^.^...^.^.^...^.^.^.^.^.^.^.^.^.^.^...^..................................................
.............................................................................................................................................
.................................................^.^.^...^.....^.....^...^.^.^...^.......^.^.................................................
.............................................................................................................................................
................................................^...^.^.^...^.^.^.....^.^.^.^.^.^.....^.^...^................................................
.............................................................................................................................................
...............................................^.^.^.^.....^.....^...^.^.^.^.^...^.^.^.^...^.^...............................................
.............................................................................................................................................
..............................................^...^.^.^.^.^.^.^.^.^.^.^.^.....^.^.^.......^.^.^..............................................
.............................................................................................................................................
.............................................^.^...^.^.^.^...^...^.^...^.^...........^...^.^.^.^.............................................
.............................................................................................................................................
............................................^.^...^.^...^.^...^.^.^.^.....^.^.^.^.^...^.^.^...^.^............................................
.............................................................................................................................................
...........................................^.^.^.....^.^.^.^.^.......^.....^.^.^.^.^.^.....^.....^...........................................
.............................................................................................................................................
..........................................^.^.^.....^.^...^.^.^.^.....^.^.^.....^.^.....^.....^.^.^..........................................
.............................................................................................................................................
.........................................^.^.^.^...^.^.^.^...^.....^.^...^.....^.^.^.^.^.^.^...^.^.^.........................................
.............................................................................................................................................
........................................^.......^.^.^.^.^.^.^...^...^.^.^.....^...^...^.^.......^.^.^........................................
.............................................................................................................................................
.......................................^...^...^.^.....^.^...^.^...^.^.^.^...^.^.^.^.^...^.^.^...^...^.......................................
.............................................................................................................................................
......................................^.^.^...^.^.....^.^...^.^.....^.^...^...^.^.^.^...^.^.^...^.^...^......................................
.............................................................................................................................................
.....................................^.^.^...^.^.^.^.^...^.^.^.^.....^...^.......^.^.^.^.^.^.^.^...^...^.....................................
.............................................................................................................................................
....................................^...^.....^.^.^.^.^.^.^.^.....^.^...^.^.^.^...^.^.^.....^.^.....^.^.^....................................
.............................................................................................................................................
...................................^...^.^.^.^.^.^.....^...^...^.^.^...^.^.^.....^.....^.^.^...^.^.^.^.^.^...................................
.............................................................................................................................................
..................................^.^.^.......^.^.^...^...^.^.^...^.^.^.....^.^.^.^.^.^.^.^.^.^.^...^.^.^.^..................................
.............................................................................................................................................
.................................^.....^.^.^.^.^.^.....^.^.^.^.^.^.^.^.^...^.^...^...^.^.^.....^.^.....^...^.................................
.............................................................................................................................................
................................^.^.^...^.....^.^.^.^...^.^.^...^.....^.^.^.^.^.^.^...^.^.^.^...^.^.......^.^................................
.............................................................................................................................................
...............................^...^.^.^.^.^.....^.^.....^.....^.^.....^.......^.^.^.........^.^...^.^.^...^.^...............................
.............................................................................................................................................
..............................^.^.^.^.....^.^...^.^...^.^.....^.^.^.^.^.^...^...^.....^.^.^.^.^.^.^...^.^.^...^..............................
.............................................................................................................................................
.............................^...^.^.^.^.^.^...^.^.^.^.^.^.^.....^.^.^...^...^.^...^.^.^...^.^...^...^.^...^...^.............................
.............................................................................................................................................
............................^.^...^.......^.^.^...^.....^.....^.^.^.........^.^.^.^.^...^.^...^.^...^.^...^...^.^............................
.............................................................................................................................................
...........................^.......^.^.^.^.^.......^...^.^.......^.^...^.^.^.^...^.^.^.^.^.^...^.^...^.^...^.^.^.^...........................
.............................................................................................................................................
..........................^.^.^.....^.^.^.^.^...^.......^.^...^.^.^...^.^.^.^.^...^.^.^.^.^.^.....^.^.........^...^..........................
.............................................................................................................................................
.........................^.^...^.^.^.^.^.^.^...^.^...^...^...^...^.^...^...^.^.^.^.^...^...^...^...^.^.^.^...^.^...^.........................
.............................................................................................................................................
........................^.^.....^.^...^...^...^.^...^.^...^.^.^.^...^.^.^.^.^...^.^...^.^...^.^.^.^...^.^...^.^.^.^.^........................
.............................................................................................................................................
.......................^...^...^.......^.^.^.^.^.............^.^.^.^.^.^.^.^.^.^.^...^.^...^.....^.^.......^.^...^.^.^.......................
.............................................................................................................................................
......................^.^...^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.^...^...^...^.^.^.^.^.....^...^...^.^.^.^.^.^.^...^.^......................
.............................................................................................................................................
.....................^.^...^.^.^.....^.^...^.^...^.^.^...^.^.^.^.^.^.^.^.^...^.....^.^.^.......^...^...^.....^.^...^.^.^.....................
.............................................................................................................................................
....................^.....^...^...^.^.^...^.^.^.^.^.^...^.^.^...^.^.....^.^.^.........^.^.^...^.^.^...^.^.^...^.^...^...^....................
.............................................................................................................................................
...................^.^.........^.^.......^.....^.^...^.^.^.^.^.....^.^.....^...^...^.^.^.^.^.^.^.^.....^...^.^...^.....^.^...................
.............................................................................................................................................
..................^.^...^.^.^...^...^.^...^.^...^.^...^.^.^.^...^.^.^.^.....^...^...^.^...^.^...^.^.^...^.....^...^...^...^..................
.............................................................................................................................................
.................^.^.^.^.^.^.........^...^.^.^...^.^.......^.^...^.....^.^...^.^.^.^.^.^.^...^.........^.^.^...^.^.^.....^.^.................
.............................................................................................................................................
................^.^.....^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^...^.^.^................
.............................................................................................................................................
...............^.....^.^...^.^.^.^.^...^.^.^.^.....^.^.^...^.^.....^.^.^.^.^.^.^.^.^.....^.^.^.^.^.^.......^.^.^.^.^.........^...............
.............................................................................................................................................
..............^.^...^.^.^.....^.^.^.^.^.^.^.^.^.^.^...^.^...^.^.^...^.^.^.^.^.^...^.^.^...^.^.^...^.^.^.^...^...^.^.^...^.^.^.^..............
.............................................................................................................................................
.............^.^.^.^.^.^.....^.^.^.^.^.^...^...^.^.^...^.^...^...^...^.^.^.^...^.^...^.....^.^.^.^.^.^...^.^.^.....^.^.^.^.^...^.............
.............................................................................................................................................
............^...^.^.......^.....^.^...^.......^.^...^.^.^.^...^.^.^.^.......^.^.^.^.^.^...^.^.^.....^.^.^.^.^.^.^.^.^.^.^...^.^.^............
.............................................................................................................................................
...........^.^...^.^.^...^.^.^.....^.....^.^...^...^.^.^...^...^.^.^...^...^...^...^.^...^.^.^.^...^.^...^...^.^.^.^.^.^.^.......^...........
.............................................................................................................................................
..........^.^.^.^.^.^.^.^...^...^.^...^...^.^...^...^...^...^.^.......^...^.^.^.....^.^.^...^...^.^.^.^.^.^.^.....^.^.^...^.^.^.^.^..........
.............................................................................................................................................
.........^.^.^.^.^.^.^.......^...^.^.^.^...^.^...^.^...^.^...^...^...^.....^.....^.^...^.^.^.^...^.^...^.^.^.^.....^.^.^.^.^.....^.^.........
.............................................................................................................................................
........^.^...^.^.^.^.....^.^...^.^.^...^...^.^.^.........^.^.....^.^.^.^.^.^.^.^.^.^...........^...^.....^.....^.^...^.^.^.^.^...^.^........
.............................................................................................................................................
.......^...^...^.^.........^.....^.^.^.^.^.^.^...^...^.^.^.^.....^.^.^.....^.^.^.....^.^.^.^.^...^...^.^.^.....^.^...^.^.^.^.....^.^.^.......
.............................................................................................................................................
......^...^...^.^...^.^.^.^.^.^...^.^.^.^.^.^.^...^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.......^.^.^.^...^.^.^.^.^.^.^...^...^.^...^.^.....^......
.............................................................................................................................................
.....^.^.^.^...^.....^...^.^.^...^.^.^.^.^.^.^...^...^.^.^.^.^.^.^.^...^.^...^.^.^...^...^.^.^.^.....^.^...^.^.^.^.^.^...^...^.......^.^.....
.............................................................................................................................................
....^.^.^...^.^...^...^.^...^.^...^.^...^.^.....^.....^.^.^.^...^.^.^.....^.^.^...^.^.^...^.....^.^.^.^...^.^...^.....^.^.^.^.^.^...^.^.^....
.............................................................................................................................................
...^...^.^.....^.^.^.^.......^.^.^.....^.^...^.^.^.^.^.^...^.^.^...^.^.....^...^.^...^...^.....^.^...^...^...^...^...^...^.^...^.^.^.....^...
.............................................................................................................................................
..^...........^.^.^.^...^.^.^.....^.........^.^.^.^...^...^.....^.^...^.......^.^.^.^.^.^...^.^...^...^.^.^.^.^...^.^.^.....^.^.^...^.^.^.^..
.............................................................................................................................................
.^.....^.....^.^...^.^.............^.^.^.^...^...^.^.^.^...^.^.....^...^.^.^.^...^.......^...^.^.^.......^.....^.^.^.....^.........^...^.^.^.
............................................................................................................................................."""


TEST = """.......S.......
...............
.......^.......
...............
......^.^......
...............
.....^.^.^.....
...............
....^.^...^....
...............
...^.^...^.^...
...............
..^...^.....^..
...............
.^.^.^.^.^...^.
..............."""


def t1():
    positions = set()

    lines = TEXT.splitlines()

    positions.add(lines[0].index("S"))
    split_count = 0

    for line in lines[1:]:
        new_positions = set()

        for p in positions:
            if line[p] == "^":
                split_count += 1

                if p - 1 >= 0:
                    new_positions.add(p - 1)
                if p + 1 < len(line):
                    new_positions.add(p + 1)
            else:
                new_positions.add(p)

        positions = new_positions
    print(split_count)


def t2():
    lines = TEXT.strip().splitlines()

    start_pos = lines[0].index("S")

    paths = {start_pos: 1}

    for line in lines[1:]:
        new_paths = {}

        for pos, count in paths.items():
            if pos < len(line) and line[pos] == "^":
                left = pos - 1
                right = pos + 1
                if left >= 0:
                    new_paths[left] = new_paths.get(left, 0) + count
                if right < len(line):
                    new_paths[right] = new_paths.get(right, 0) + count
            else:
                # No splitter: continue straight down
                new_paths[pos] = new_paths.get(pos, 0) + count

        paths = new_paths

    print(sum(paths.values()))


if __name__ == "__main__":
    t1()
    t2()
